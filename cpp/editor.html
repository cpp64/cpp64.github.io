<html>
   <head>
      <meta charset = "UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <link rel="stylesheet" type="text/css" href="/styles/style.css">
      <link rel="icon" type="image/png" sizes="192x192"  href="/icons/android-icon-192x192.png">
      <title>C++ базовый</title>
      <link rel="stylesheet" href="codemirror/codemirror.css">
      <style>
         .CodeMirror {border: 1px inset #dee;}
      </style>
   </head>
   <body>
      <div class="topnav">
         <img class="logo" src="/icons/dove32w2.ico">
         <a href="/index.html">Информатика</a>
         <a href = "/lessons/7kl.html">7 класс</a>
         <a href = "/lessons/8kl.html">8 класс</a>
         <a href = "/lessons/9kl.html">9 класс</a>
         <a href="/oge.html">ОГЭ</a>
         <img class="wing" src="/icons/wing64.png">
      </div>
      <div class="main">
         <div id="codediv"
            style="position: absolute; width: 200px; height: 200px; top: 0px; left: 10px;">
         </div>
         <script src="codemirror/codemirror.js"></script>
         <script src="codemirror/matchbrackets.js"></script>
         <script src="codemirror/clike.js"></script>
         <script src="JSCPP.es5.min.js"></script>
         <script src="velosiped.js"></script>
         <script type="text/javascript">
            //сделать textarea не мпсштабируемыми
            //JSCPP: iostream нельзя подключать раньше, чем stdio.h
            putButton("0px","0px","Запуск","run()","run button");
            putButton("8px","0px","Копировать код","cod()","cod button");
            var cppEditor = CodeMirror(
               document.getElementById("codediv"),
               {
                   lineNumbers: true,
                   matchBrackets: true,
                   mode: "text/x-c++src"
               }
            );
            putTextArea('8px','0px','5','40','2');
            putTextArea('8px','0px','5','40','3');
            putText("8px","50px","Код", "text1");
            putText("8px","0px","Вход", "text2");
            putText("8px","0px","Выход", "text3");
            appendBottom("codediv", "text1");
            appendBottom1("text2", "codediv", 10);
            appendBottom("2", "text2");
            appendBottom("text3", "2");
            appendBottom("3", "text3");
            appendBottom("run button", "3");
            appendBottom("cod button", "3");
            alignRight("run button", "3");
            document.getElementById("codediv").style.width =
            document.getElementById("2").offsetWidth;
            function cod() {
               navigator.clipboard.writeText(
                  "#include <cmath>\n" +
                  "#include <iostream>\n" +
                  "#define bool int\n" +
                  "#define or ||\n" +
                  "#define and &&\n" +
                  "using namespace std;\n" +
                  "double round(double d)\n" +
                  "{\n" +
                  "    return floor(d+0.5);\n" +
                  "}\n" +
                  "int main(){\n" +
                  cppEditor.getValue() +
                  "\nreturn 0;\n}"
               );
            }
            function run() {
                var output = "";
                var config = {
                    stdio: {
                        write: function(s) {
                            output += s;
                        }
                    }
                };
                var code = 
                    "#include <cmath>\n" +
                    "#include <iostream>\n" +
                    "#define bool int\n" +
                    "#define or ||\n" +
                    "#define and &&\n" +
                    "double round(double d)\n" +
                    "{\n" +
                    "    return floor(d+0.5);\n" +
                    "}\n" +
                    "int main(){\n" +
                    cppEditor.getValue() +
                    "\nreturn 0;\n}";
                var input = document.getElementById("2").value;
                var exitCode;
                try {
                   exitCode = JSCPP.run(code, input, config);
                   document.getElementById("3").value = output;
                } catch(err) {
                   document.getElementById("3").value = "Error: " + (err.message || err);
                }
            }
         </script>
      </div>
   </body>
</html>
